<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dentalis | Ù†Ø¬Ø§Ø­ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #007AFF;
            --success: #34C759;
            --bg: #F5F7FA;
            --text: #1D1D1F;
            --white: #FFFFFF;
        }
        body {
            margin: 0;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: var(--bg);
            font-family: 'Cairo', 'Inter', sans-serif;
            color: var(--text);
            text-align: center;
        }
        .card {
            background: var(--white);
            padding: 60px 40px;
            border-radius: 40px;
            box-shadow: 0 40px 100px rgba(0,0,0,0.08);
            max-width: 500px;
            width: 90%;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .app-logo {
            width: 150px;
            height: 150px;
            margin-bottom: 25px;
            object-fit: contain;
        }
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--success));
        }
        .icon-container {
            position: relative;
            width: 120px;
            height: 120px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .icon {
            font-size: 80px;
            color: var(--success);
            z-index: 2;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: scaleIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .icon-bg {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
            background: rgba(52, 199, 89, 0.1);
            border-radius: 50%;
            animation: pulse 2s infinite;
            z-index: 1;
        }
        h1 {
            color: var(--text);
            margin-bottom: 15px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        p {
            color: #636366;
            font-size: 17px;
            line-height: 1.6;
            margin-bottom: 35px;
        }
        .trust-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background: #F2F2F7;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 13px;
            color: #8E8E93;
            margin-bottom: 30px;
        }
        .btn {
            background: var(--primary);
            color: white;
            text-decoration: none;
            padding: 16px 40px;
            border-radius: 35px;
            font-weight: 700;
            display: inline-block;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 15px 35px rgba(0,122,255,0.25);
            font-size: 16px;
        }
        .btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 45px rgba(0,122,255,0.35);
            background: #0062CC;
        }
        .loader {
            width: 60px;
            height: 60px;
            border: 4px solid #E5E5EA;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            display: inline-block;
            animation: spin 0.8s cubic-bezier(0.4, 0, 0.2, 1) infinite;
            margin-bottom: 30px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @keyframes scaleIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        @keyframes pulse {
            0% { transform: translate(-50%, -50%) scale(0.95); opacity: 1; }
            70% { transform: translate(-50%, -50%) scale(1.3); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(0.95); opacity: 0; }
        }
        .footer-logo {
            margin-top: 40px;
            font-weight: 700;
            font-size: 14px;
            color: #C7C7CC;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
    </style>
</head>
<body>

<div class="card">
    <img src="logo.png" alt="Dentalis Logo" class="app-logo">
    <div class="icon-container">
        <div id="status-icon" class="loader"></div>
        <div id="icon-pulse" style="display:none;" class="icon-bg"></div>
    </div>
    
    <h1 id="title">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚...</h1>
    
    <div class="trust-badge" id="trust-badge">
        <span id="trust-icon">ðŸ”’</span>
        <span id="trust-text">Ø§ØªØµØ§Ù„ Ø¢Ù…Ù† ÙˆÙ…ÙˆØ«Ù‚ Ù…Ù† NuclearMindSys</span>
    </div>

    <p id="message">ØªÙ… ØªÙˆØ«ÙŠÙ‚ Ø¯Ø®ÙˆÙ„Ùƒ Ø¨Ù†Ø¬Ø§Ø­. Ù†Ù‚ÙˆÙ… Ø§Ù„Ø¢Ù† Ø¨Ø¥Ø¹Ø§Ø¯ØªÙƒ Ø¥Ù„Ù‰ Dentalis Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù† Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¹Ù…Ù„Ùƒ.</p>
    
    <a href="javascript:void(0)" onclick="redirectToApp()" class="btn" id="manual-btn">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¢Ù†</a>
    
    <div class="footer-logo">
        NuclearMindSys <span style="color:var(--primary)">â€¢</span> Digital Intelligence
    </div>
</div>

<script>
    function getLang() {
        return window.navigator.language.startsWith('ar') ? 'ar' : 'en';
    }

    const translations = {
        ar: {
            title: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚...",
            message: "ØªÙ… ØªÙˆØ«ÙŠÙ‚ Ø¯Ø®ÙˆÙ„Ùƒ Ø¨Ù†Ø¬Ø§Ø­. Ù†Ù‚ÙˆÙ… Ø§Ù„Ø¢Ù† Ø¨Ø¥Ø¹Ø§Ø¯ØªÙƒ Ø¥Ù„Ù‰ Dentalis Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù† Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¹Ù…Ù„Ùƒ.",
            btn: "Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¢Ù†",
            trust: "Ø§ØªØµØ§Ù„ Ø¢Ù…Ù† ÙˆÙ…ÙˆØ«Ù‚ Ù…Ù† NuclearMindSys",
            successTitle: "ØªÙ… Ø¨Ù†Ø¬Ø§Ø­!",
            successMsg: "ØªÙ…Øª Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¬Ù„Ø³Ø© Ø¨Ù†Ø¬Ø§Ø­. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø¥ØºÙ„Ø§Ù‚ Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¨Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø¨Ø¯Ø¡ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù…."
        },
        en: {
            title: "Returning to App...",
            message: "You have signed in successfully. We are now redirecting you back to Dentalis securely to resume your work.",
            btn: "Return to App Now",
            trust: "Secure Connection Verified by NuclearMindSys",
            successTitle: "Success!",
            successMsg: "Session synchronized successfully. You can now safely close this window and start using the system."
        }
    };

    function updateUI(isSuccess = false) {
        const lang = getLang();
        const t = translations[lang];
        document.dir = lang === 'ar' ? 'rtl' : 'ltr';
        
        if (isSuccess) {
            document.getElementById('status-icon').className = "icon";
            document.getElementById('status-icon').innerHTML = "âœ“";
            document.getElementById('icon-pulse').style.display = "block";
            document.getElementById('title').innerText = t.successTitle;
            document.getElementById('message').innerText = t.successMsg;
            document.getElementById('trust-icon').innerText = "âœ…";
        } else {
            document.getElementById('title').innerText = t.title;
            document.getElementById('message').innerText = t.message;
        }
        document.getElementById('manual-btn').innerText = t.btn;
        document.getElementById('trust-text').innerText = t.trust;
    }

    function redirectToApp() {
        const hash = window.location.hash;
        const search = window.location.search;
        
        // Ø§Ù„ØªÙ‚Ø§Ø· Ø£ÙŠ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø³ÙˆØ§Ø¡ ÙƒØ§Ù†Øª ØªØ¨Ø¯Ø£ Ø¨Ù€ ? Ø£Ùˆ #
        const params = search || hash;
        
        if (params) {
            // Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ Ø§Ù„Ù…Ø®ØµØµ Ù…Ø¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ÙƒØ§Ù…Ù„Ø©
            const deepLink = "io.supabase.clinic://login-callback/" + params;
            console.log("Redirecting to:", deepLink);
            window.location.href = deepLink;
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
            setTimeout(() => {
                updateUI(true);
            }, 2000);
        } else {
            console.warn("No auth parameters found in URL");
            updateUI(true); 
        }
    }

    // Initial check
    updateUI(false);
    
    // Auto-redirect after a short delay
    setTimeout(redirectToApp, 1000);
</script>

</body>
</html>
